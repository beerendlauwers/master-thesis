attr FunBindR FunBindsR
--  syn  infer                                         :: Contract
  syn  subst                                         :: Subst

sem FunBindR
  | FBHoleR
      lhs   .subst  =   SId
  | FunBindR
      lhs  .subst   =   @loc.subst'
--      rhs  .locsubst   =   @loc.localsubsts
--      pats .freshContractVariable = fst @loc.conversionResults
      loc  .clhs    =   lastc $ stripQuantifiers $ @loc.cfunc
           .conversionResults = envLU @lhs.freshContractVariable @name.copy @lhs.env
           .cfunc   =   snd @loc.conversionResults
           .crhs    =   @rhs.infer
           .unify   =   unifyC  @loc.clhs @loc.crhs
           .unify'  =   splitSubsts @loc.unify
           .localsubsts = snd @loc.unify'
           .subst'  =   fst @loc.unify' `o` @rhs.subst
           .infer'  =   subst @loc.subst' @loc.cfunc
  
sem FunBindsR
  | Cons 
      lhs   .subst  =   @hd.subst `o` @tl.subst -- TODO: Collect substitution information of all definitions?
  | Nil
      lhs   .subst  =   SId


